\section{Reparametrizační trik}

\begin{algorithm}[hbt!]
    \caption{Stochastic optimization of the ELBO.}\label{alg:reparam_trick}
        \KwData{}
                \hspace{6mm}$\mathcal{D}$: Dataset\\
                \hspace{6mm}$q_\phi(\textbf{z}\mid\textbf{x})$: Inferenční model (enkodér)\\
                \hspace{6mm}$p_\theta(\textbf{x}, \textbf{z})$: Generativní model (dekodér)\\
        \KwResult{}
        \hspace{6mm}$\boldsymbol{\theta}, \boldsymbol{\phi}$: Naučené parametry\\

        $\boldsymbol{\theta}, \boldsymbol{\phi} \gets \text{inicializace parametrů}$

        \While{SGD not converged}{
            $\mathcal{M} \sim \mathcal{D}$ (Random minibatch of data)\\
            $\boldsymbol{\epsilon} \sim p(\boldsymbol{\epsilon})$ (Random noise for every datapoint in $\mathcal{M}$)\\
            Compute $\tilde{\mathcal{L}}$ and its gradients $\nabla_{\theta,\phi}(\mathcal{M}, \boldsymbol{\epsilon})$\\
            Update $\boldsymbol{\theta}$ and $boldsymbol{phi}$ using SGD optimizer
            }
\end{algorithm}